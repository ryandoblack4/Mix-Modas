<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/style_categorias.css">
    <title>Lista de Desejos - Mix-Modas</title>
</head>
<body>

    <header>
        <div class="logo">
            <a href="/templates/index.html" style="color: white; text-decoration: none; font-size: 1.5rem; font-weight: 700;">
                <img src="/static/css/logo-mixmodas.png" alt="Mix-Modas" class="logo-img">
            </a>
        </div>
        <div class="search-bar">
            <input type="text" placeholder="O que voc√™ procura hoje?" id="searchInput">
            <button onclick="pesquisar()">Pesquisar</button>
        </div>
        <div class="icons">
            <a href="/templates/lista_desejos.html" id="listaDesejosLink">‚ù§Ô∏è Lista de Desejos (0)</a>
            <a href="/templates/tela_login.html">üë§ Entrar</a>
            <a href="/templates/carrinho.html" id="carrinhoLink">üõí Seu Carrinho (0)</a>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="/templates/masculino.html">Masculino</a></li>
            <li><a href="/templates/feminino.html">Feminino</a></li>
            <li><a href="/templates/infantil.html">Infantil</a></li>
        </ul>
    </nav>

    <div class="promo-bar">
        Frete gr√°tis para compras acima de <span>R$99,99</span> 
    </div>

    <div class="breadcrumb">
        <a href="/templates/index.html">Home</a> > <span>Lista de Desejos</span>
    </div>

    <section class="page-title">
        <h1>‚ù§Ô∏è Minha Lista de Desejos</h1>
        <p>Guarde seus produtos favoritos para comprar depois</p>
    </section>

    <section class="produtos-container">
        <div id="produtos-grid" class="produtos-grid"></div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>üëó Mix-Modas</h3>
                <p>Sua loja de moda preferida com os melhores pre√ßos e tend√™ncias.</p>
            </div>
            <div class="footer-section">
                <h4>Institucional</h4>
                <a href="#">Sobre n√≥s</a>
                <a href="#">Trocas e Devolu√ß√µes</a>
                <a href="#">Pol√≠tica de Privacidade</a>
            </div>
            <div class="footer-section">
                <h4>Atendimento</h4>
                <a href="#">Central de Ajuda</a>
                <a href="#">Fale Conosco</a>
                <a href="#">WhatsApp</a>
            </div>
            <div class="footer-section">
                <h4>Redes Sociais</h4>
                <div class="social-links">
                    <a href="#">üì∑ Instagram</a>
                    <a href="#">üìò Facebook</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2025 Mix-Modas - Todos os direitos reservados</p>
        </div>
    </footer>

    <script>
        function pesquisar() {
            const termo = document.getElementById('searchInput').value;
            if (termo.trim()) {
                alert(`Pesquisando por: ${termo}`);
            }
        }

        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                pesquisar();
            }
        });

        function atualizarCarrinhoVisual() {
            const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
            const total = carrinho.reduce((t, p) => t + (p.quantidade || 0), 0);
            const link = document.getElementById('carrinhoLink');
            if (link) link.textContent = `üõí Seu Carrinho (${total})`;
        }

        function atualizarFavoritosVisual() {
            const fav = JSON.parse(localStorage.getItem('favoritos')) || [];
            const link = document.getElementById('listaDesejosLink');
            if (link) link.textContent = `‚ù§Ô∏è Lista de Desejos (${fav.length})`;
        }

        function carregarFavoritos() {
            const grid = document.getElementById('produtos-grid');
            const fav = JSON.parse(localStorage.getItem('favoritos')) || [];
            console.log('Favoritos carregados:', fav);
            grid.innerHTML = '';

            if (fav.length === 0) {
                grid.innerHTML = '<p>Sua lista de desejos est√° vazia.</p>';
                return;
            }

            fav.forEach(prod => {
                const card = document.createElement('article');
                card.className = 'produto-card';
                card.innerHTML = `
                    <img src="${prod.imagem || '/static/img/sem-foto.png'}" alt="${prod.nome}" class="produto-imagem">
                    <div class="produto-info">
                        <h3 class="produto-titulo">${prod.nome}</h3>
                        <p class="produto-preco">R$ ${prod.preco.toFixed(2)}</p>
                        ${prod.idade ? `<p class="produto-idade">Idade: ${prod.idade}</p>` : `<p class="produto-tamanho">Tamanho: ${prod.tamanho}</p>`}
                        ${prod.genero ? `<p class="produto-genero">G√™nero: ${prod.genero}</p>` : `<p class="produto-cor">Cor: ${prod.cor}</p>`}
                        <div class="produto-acoes">
                            <button class="btn-carrinho">Adicionar ao Carrinho</button>
                            <button class="btn-remover">Remover</button>
                        </div>
                    </div>
                `;
                card.querySelector('.btn-carrinho').addEventListener('click', () => {
                    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
                    const idx = carrinho.findIndex(p => p.id === prod.id);
                    if (idx >= 0) carrinho[idx].quantidade += 1;
                    else carrinho.push({ ...prod, quantidade: 1 });
                    localStorage.setItem('carrinho', JSON.stringify(carrinho));
                    atualizarCarrinhoVisual();
                    alert(`${prod.nome} adicionado ao carrinho!`);
                });
                card.querySelector('.btn-remover').addEventListener('click', () => {
                    if (confirm(`Remover ${prod.nome} dos favoritos?`)) {
                        const updatedFav = fav.filter(p => p.id !== prod.id);
                        localStorage.setItem('favoritos', JSON.stringify(updatedFav));
                        carregarFavoritos(); 
                        atualizarFavoritosVisual();
                    }
                });
                grid.appendChild(card);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            carregarFavoritos();
            atualizarCarrinhoVisual();
            atualizarFavoritosVisual();
        });

        function testarLocalStorage() {
            const fav = JSON.parse(localStorage.getItem('favoritos')) || [];
            alert(`Favoritos no localStorage: ${fav.length} itens. Detalhes: ${JSON.stringify(fav)}`);
        }
    </script>

    <section class="produtos-container">
        <button onclick="testarLocalStorage()">Testar localStorage</button>
        <div id="produtos-grid" class="produtos-grid"></div>
    </section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof window !== 'undefined' && window.firebase && window.auth && window.db) {
            if (typeof configurarFirebase === 'function') {
                configurarFirebase(window.auth, window.db);
            }
        }
    });
</script>

</body>
</html>