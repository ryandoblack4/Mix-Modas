<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('loginForm');
  const mensagem = document.getElementById('mensagem');
  const loading = document.getElementById('loading');
  const botao = form.querySelector('.login-button');

  form.addEventListener('submit', async function(e) {
    e.preventDefault();

    const email = document.getElementById('email').value.trim();
    const senha = document.getElementById('password').value.trim();

    mensagem.textContent = '';
    mensagem.style.color = '#d6005d';
    loading.style.display = 'block';
    botao.disabled = true;

    if (!email || !senha) {
      mensagem.textContent = 'Preencha e-mail e senha.';
      loading.style.display = 'none';
      botao.disabled = false;
      return;
    }

    try {
      const resultado = await loginFirebaseFrontend(email, senha);

      if (!resultado.success) {
        mensagem.textContent = resultado.error;
        loading.style.display = 'none';
        botao.disabled = false;
        return;
      }

      mensagem.style.color = '#27ae60';
      mensagem.textContent = 'Login realizado com sucesso!';

      setTimeout(() => {
        window.location.href = '/templates/index.html';
      }, 800);

    } catch (err) {
      console.error(err);
      mensagem.textContent = 'Erro ao fazer login.';
      loading.style.display = 'none';
      botao.disabled = false;
    }
  });
});
</script>
